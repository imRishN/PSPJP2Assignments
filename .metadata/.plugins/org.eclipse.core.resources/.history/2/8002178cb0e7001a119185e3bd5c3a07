package controllers;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import models.Summary;
import models.Transaction;

public class SummaryReportGenerator {
	private List<Transaction> transactions;
	private HashMap<String, Integer> map; 
	public SummaryReportGenerator()
	{
		FeeCalculator feeCalculator = new FeeCalculator();
		map = new HashMap<String, Integer>();
		transactions = feeCalculator.getTransactions();
		generateSummaryReport();
	}
	
	public void generateSummaryReport()
	{
		for(Transaction transaction: transactions)
		{
			String data = transaction.getClientId() 
							+ "," + transaction.getTransactionType()
							+ "," + transaction.getTransactionDateString()
							+ "," + transaction.getPriorityFlag();
			if(map.containsKey(data))
			{
				int value = map.get(data);
				value+=transaction.getTransactionFees();
				map.replace(data, value);
			}
			else {
				map.put(data, transaction.getTransactionFees());
			}
		}
	}
	
	public List<Summary> printSummaryReport()
	{
		List<Summary> summaryReport = new ArrayList<Summary>();
		for (Map.Entry<String,Integer> entry : map.entrySet())  
		{
			String data = entry.getKey();
			int fees = entry.getValue();
			String field[] = data.split(",");
			Summary summary = new Summary(field[0], field[1], field[2], field[3], fees);
			summaryReport.add(summary);
		}
		return summaryReport;
	}
}
